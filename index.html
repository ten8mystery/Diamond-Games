<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diamond - Better Gaming</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #030308;
      --panel: rgba(255,255,255,0.03);
      --glass-soft: rgba(255,255,255,0.05);
      --accent1: 220 85% 62%;
      --accent2: 280 85% 62%;
      --text: #e7eef6;
      --text-soft: rgba(231,238,246,0.75);
      --radius: 14px;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* HUD */
    .hud {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 92%;
      max-width: 1250px;
      padding: 14px 22px;
      display:flex;
      align-items:center;
      gap:16px;
      border-radius: var(--radius);
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(10px) saturate(70%);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow: 0 4px 16px rgba(0,0,0,0.35);
      z-index: 49 !important;
    }

    .logo { display:flex; align-items:center; gap:12px; }

    .logo img {
      width:42px;
      height:42px;
      border-radius:10px;
      box-shadow:0 4px 18px rgba(147,51,234,0.4);
    }

    .logo h1 { font-size:20px; font-weight:700; margin-bottom:-4px; }
    .logo small { font-size:12px; color:var(--text-soft); }

    .right { margin-left:auto; display:flex; align-items:center; gap:10px; }

    .hud button {
      padding:10px 18px;
      border:none;
      border-radius:10px;
      background:rgba(255,255,255,0.05);
      color:white;
      font-weight:600;
      cursor:pointer;
      transition:150ms;
    }

    .hud button:hover {
      background:rgba(255,255,255,0.10);
      transform:translateY(-1px);
    }

    .hud button.active {
      background:linear-gradient(135deg, hsl(var(--accent1)), hsl(var(--accent2)));
      box-shadow:0 6px 20px rgba(0,0,0,0.35);
    }

    .pill {
      padding:6px 12px;
      background:rgba(255,255,255,0.06);
      border-radius:999px;
      font-size:13px;
    }

    /* SEARCH (now global, not part of hero) */
    #searchContainer {
      margin-top:150px;
      display:none;
      justify-content:center;
    }

    .search {
      width:680px;
      max-width:92%;
      padding:14px 20px;
      border-radius:999px;
      display:flex;
      background:rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow:0 0 8px rgba(99,102,241,0.18);
      transition:150ms;
    }

    .search:focus-within {
      border:1px solid rgba(99,102,241,0.45);
      box-shadow:0 0 14px rgba(99,102,241,0.35);
    }

    #settingsModal.show {
  opacity: 1 !important;
}

    .search input {
      flex:1;
      background:transparent;
      border:none;
      outline:none;
      font-size:16px;
      color:var(--text);
    }

    /* GRID */
    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));
      gap:26px;
      padding:40px 22px;
      max-width:1250px;
      margin:auto;
    }

    .card {
      background:rgba(255,255,255,0.03);
      border:1px solid rgba(255,255,255,0.05);
      border-radius:var(--radius);
      height:300px;
      padding:12px;
      transition:150ms;
      box-shadow:0 2px 6px rgba(0,0,0,0.25);
    }

    .card:hover {
      transform:translateY(-3px);
      box-shadow:0 4px 10px rgba(0,0,0,0.22);
    }

    .thumb {
      width:100%;
      height:155px;
      border-radius:10px;
      object-fit:cover;
      box-shadow:0 3px 12px rgba(0,0,0,0.28);
    }

    .meta { text-align:center; padding-top:14px; }
    .meta h3 { font-size:18px; margin-bottom:10px; }

    .play {
      padding:10px 16px;
      border:none;
      border-radius:10px;
      background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      color:white;
      cursor:pointer;
      transition:150ms;
    }

    .play:hover { transform:translateY(-2px); }

  </style>
</head>

<body>

  <!-- TOP BAR -->
  <div class="hud">
    <div class="logo">
      <img src="favicon.png" alt="Logo">
      <div>
        <h1>Diamond</h1>
        <small>Upgraded Gaming</small>
      </div>
    </div>

    <div class="right">
      <button id="homeTab" class="active">Home</button>
      <button id="gamesTab">Games</button>
      <button id="appsTab">Apps</button>
      <button id="unlockerTab">Unlocker</button>
      <span id="gamesCount" class="pill" style="display:none;">Count: 0</span>
      <button id="settingsButton">Settings</button>
    </div>
  </div>

  <!-- SEARCH BAR NOW GLOBAL -->
  <div id="searchContainer">
    <div class="search">
      <input id="q" placeholder="Search...">
    </div>
  </div>

  <main>
    <!-- HOME SECTION -->
    <section id="homeSection" style="padding-top:130px; text-align:center;">
      <h2 style="
        font-size:48px;
        font-weight:800;
        background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
        -webkit-background-clip:text;
        -webkit-text-fill-color:transparent;
      ">
        Diamond â€” Upgraded Gaming
      </h2>

      <p style="color:var(--text-soft); margin-top:6px;">
        Dive into endless gaming.
      </p>

      <div style="max-width:1250px; margin:40px auto; padding:0 22px;">
        <h3 style="text-align:left; font-size:25px; margin-bottom:3px;">Featured Games:</h3>

        <div class="grid" id="featuredGrid"></div>
      </div>
    </section>

    <!-- HERO REMOVED COMPLETELY -->

    <!-- GRID FOR GAMES/APPS -->
    <section class="grid" id="grid" style="display:none;"></section>

  </main>

  <!-- MODAL -->
  <div id="modal" style="
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.75);
    z-index:50;
    justify-content:center;
    align-items:center;
  ">
    <div style="
      width:95%;
      max-width:1500px;
      height:90vh;
      background:#0b0b11;
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,0.05);
      overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.45);
      position:relative;
    ">
      <button id="closeModal" style="
        position:absolute;
        top:16px;
        right:20px;
        padding:8px 12px;
        background:rgba(255,255,255,0.12);
        border:none;
        border-radius:8px;
        color:white;
        cursor:pointer;
        z-index:100;
      ">Close</button>

      <button id="fullscreenBtn" style="
        position:absolute;
        top:16px;
        right:90px;
        padding:8px 12px;
        background:rgba(255,255,255,0.12);
        border:none;
        border-radius:8px;
        color:white;
        cursor:pointer;
        z-index:100;
      ">Fullscreen</button>

      <iframe id="gameFrame"
        style="width:100%;height:100%;border:none"
        sandbox="allow-scripts allow-same-origin allow-pointer-lock"></iframe>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div id="settingsModal" style="
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.55);
    z-index:60;
    justify-content:center;
    align-items:center;
    transition:250ms;
    opacity:0;
  ">
    <div style="
      background:#111;
      padding:30px;
      border-radius:12px;
      width:92%;
      max-width:420px;
      border:1px solid rgba(255,255,255,0.08);
      text-align:center;
      transition:300ms;
    ">
      <h2 style="margin-bottom:10px;">Settings</h2>
      <div id="themeOptions"></div>

      <button id="closeSettings" style="
        margin-top:20px;
        padding:10px 16px;
        border:none;
        border-radius:10px;
        background:rgba(255,255,255,0.08);
        color:white;
        cursor:pointer;
      ">
        Close
      </button>
    </div>
  </div>
  <script>
    /* ELEMENTS */
    const homeTab = document.getElementById('homeTab');
    const gamesTab = document.getElementById('gamesTab');
    const appsTab = document.getElementById('appsTab');
    const unlockerTab = document.getElementById('unlockerTab');

    const homeSection = document.getElementById('homeSection');
    const grid = document.getElementById('grid');
    const featuredGrid = document.getElementById('featuredGrid');

    const searchContainer = document.getElementById('searchContainer');
    const searchInput = document.getElementById('q');

    const modal = document.getElementById('modal');
    const gameFrame = document.getElementById('gameFrame');
    const closeModal = document.getElementById('closeModal');
    const fullscreenBtn = document.getElementById('fullscreenBtn');

    const settingsModal = document.getElementById('settingsModal');
    const closeSettings = document.getElementById('closeSettings');
    const settingsButton = document.getElementById('settingsButton');

    const gamesCountElement = document.getElementById('gamesCount');

    let lastActiveTab = "home";
    let GAMES = [];
    let APPS = [];

    /* FEATURED GAMES */

async function renderFeatured() {
  const data = await fetch("arcade_data.json").then(r => r.json());
  const all = data.games || [];

  const picks = ["Roblox", "Hollow Knight", "Undertale", "Deltarune"];

  featuredGrid.innerHTML = "";

  all
    .filter(g => picks.includes(g.title))
    .forEach(g => featuredGrid.appendChild(createCard(g)));
}


    /* LOAD GAMES */
    function loadGames() {
      fetch('arcade_data.json')
        .then(r => r.json())
        .then(data => {
          GAMES = data.games || [];
          render(GAMES);
          updateCount();
        });
    }

    /* LOAD APPS */
    function loadApps() {
      fetch('apps_data.json')
        .then(r => r.json())
        .then(data => {
          APPS = data.apps || [];
          render(APPS);
          updateCount();
        });
    }

    /* RENDER GRID */
    function render(items) {
      const q = searchInput.value.toLowerCase();
      grid.innerHTML = "";

      items
        .filter(item => item.title.toLowerCase().includes(q))
        .forEach(item => grid.appendChild(createCard(item)));
    }

    /* CREATE CARD */
    function createCard(item) {
      const el = document.createElement('article');
      el.className = 'card';

      const img = document.createElement('img');
      img.className = 'thumb';
      img.src = item.thumb;
      img.loading = "lazy";

      const meta = document.createElement('div');
      meta.className = 'meta';

      const h3 = document.createElement('h3');
      h3.textContent = item.title;

      const btn = document.createElement('button');
      btn.className = 'play';
      btn.textContent = 'Play';
      btn.onclick = () => openItem(item);

      meta.appendChild(h3);
      meta.appendChild(btn);
      el.appendChild(img);
      el.appendChild(meta);

      return el;
    }

    /* OPEN GAME */
    function openItem(item) {
      modal.style.display = 'flex';

      fetch(item.src)
        .then(r => r.text())
        .then(html => {
          gameFrame.contentDocument.open();
          gameFrame.contentDocument.write(html);
          gameFrame.contentDocument.close();
        })
        .catch(() => {
          gameFrame.contentDocument.open();
          gameFrame.contentDocument.write(`<h2 style="color:white;padding:20px;">Failed to load game</h2>`);
          gameFrame.contentDocument.close();
        });
    }

    /* CLOSE MODAL */
    closeModal.onclick = () => {
      modal.style.display = 'none';
      gameFrame.src = "";
    };

    /* FULLSCREEN */
    fullscreenBtn.onclick = () => {
      if (gameFrame.requestFullscreen) gameFrame.requestFullscreen();
    };

    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement) modal.style.padding = "";
    });

    /* TAB LOGIC (NO MORE HERO) */

    homeTab.onclick = () => {
      lastActiveTab = "home";

      homeTab.classList.add('active');
      gamesTab.classList.remove('active');
      appsTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      /* Show only home */
      homeSection.style.display = "block";
      grid.style.display = "none";
      searchContainer.style.display = "none";
      gamesCountElement.style.display = "none";

      renderFeatured();
    };

    gamesTab.onclick = () => {
      lastActiveTab = "games";

      gamesTab.classList.add('active');
      homeTab.classList.remove('active');
      appsTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      homeSection.style.display = "none";
      grid.style.display = "grid";
      searchContainer.style.display = "flex";
      gamesCountElement.style.display = "inline-block";

      loadGames();
    };

    appsTab.onclick = () => {
      lastActiveTab = "apps";

      appsTab.classList.add('active');
      homeTab.classList.remove('active');
      gamesTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      homeSection.style.display = "none";
      grid.style.display = "grid";
      searchContainer.style.display = "flex";
      gamesCountElement.style.display = "inline-block";

      loadApps();
    };

    unlockerTab.onclick = () => {
      unlockerTab.classList.add('active');
      homeTab.classList.remove('active');
      gamesTab.classList.remove('active');
      appsTab.classList.remove('active');

      modal.style.display = 'flex';
      gameFrame.src = "https://ihce0h92o3nndk0.pages.dev/";
    };

    /* SEARCH WORKS IN BOTH TABS */
    searchInput?.addEventListener('input', () => {
      if (lastActiveTab === "games") render(GAMES);
      if (lastActiveTab === "apps") render(APPS);
    });

    /* COUNT */
    function updateCount() {
      gamesCountElement.textContent =
        "Count: " + (lastActiveTab === "games" ? GAMES.length : APPS.length);
    }

    /* SETTINGS */
    settingsButton.onclick = () => {
      settingsModal.classList.add('show');
      settingsModal.style.display = 'flex';
    };

    closeSettings.onclick = () => {
      settingsModal.classList.remove('show');
      setTimeout(() => settingsModal.style.display = 'none', 250);
    };

    /* THEMES */
    fetch('themes.json')
      .then(r => r.json())
      .then(data => {
        const options = document.getElementById('themeOptions');
        data.themes.forEach(theme => {
          const div = document.createElement('div');
          div.className = 'theme-option';
          div.textContent = theme.name;

          div.onclick = () => {
            for (const key in theme) {
              document.documentElement.style.setProperty(key, theme[key]);
            }
            document.querySelectorAll('.theme-option')
              .forEach(o => o.classList.remove('active'));
            div.classList.add('active');
          };

          options.appendChild(div);
        });
      });

    /* INITIAL LOAD */
    renderFeatured();
  </script>

</body>
</html>

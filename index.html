<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diamond - Better Gaming</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #030308;
      --panel: rgba(255,255,255,0.03);
      --glass-soft: rgba(255,255,255,0.05);
      --accent1: 220 85% 62%;
      --accent2: 280 85% 62%;
      --text: #e7eef6;
      --text-soft: rgba(231,238,246,0.75);
      --radius: 14px;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* HUD */
    .hud {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 92%;
      max-width: 1250px;
      padding: 14px 22px;
      display:flex;
      align-items:center;
      gap:16px;
      border-radius: var(--radius);
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(14px) saturate(120%);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow: 0 4px 16px rgba(0,0,0,0.35);  
      z-index: 49 !important;
    }

    .logo { display:flex; align-items:center; gap:12px; }

    .logo img {
      width:42px;
      height:42px;
      border-radius:10px;
      box-shadow:0 4px 18px rgba(147,51,234,0.4);
    }

    .logo h1 { font-size:20px; font-weight:700; margin-bottom:-4px; }
    .logo small { font-size:12px; color:var(--text-soft); }

    .right { margin-left:auto; display:flex; align-items:center; gap:10px; }

    .hud button {
      padding:10px 18px;
      border:none;
      border-radius:10px;
      background:rgba(255,255,255,0.05);
      color:white;
      font-weight:600;
      cursor:pointer;
      transition:150ms;
    }

    .hud button:hover {
      background:rgba(255,255,255,0.10);
      transform:translateY(-1px);
    }

    .hud button.active {
      background:linear-gradient(135deg, hsl(var(--accent1)), hsl(var(--accent2)));
      box-shadow:0 6px 20px rgba(0,0,0,0.35);
    }

    .pill {
      padding:6px 12px;
      background:rgba(255,255,255,0.06);
      border-radius:999px;
      font-size:13px;
    }

    /* HERO */
    .hero {
      padding-top:130px;
      text-align:center;
    }

    .hero h2 {
      font-size:42px;
      font-weight:800;
      background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:6px;
    }

    .hero p {
      font-size:16px;
      color:var(--text-soft);
    }

    /* SEARCH */
    .search-wrap { margin-top:22px; display:flex; justify-content:center; }

    .search {
      width:680px;
      max-width:92%;
      padding:14px 20px;
      border-radius:999px;
      display:flex;
      background:rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow:0 0 8px rgba(99,102,241,0.18);
      transition:150ms;
    }

    /* ⭐ Glow restored */
    .search:focus-within {
      border:1px solid rgba(99,102,241,0.45);
      box-shadow:0 0 14px rgba(99,102,241,0.35);
    }

    .search input {
      flex:1;
      background:transparent;
      border:none;
      outline:none;
      font-size:16px;
      color:var(--text);
    }

    /* GRID */
    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));
      gap:26px;
      padding:40px 22px;
      max-width:1250px;
      margin:auto;
    }

    /* CARD */
    .card {
      background:rgba(255,255,255,0.03);
      border:1px solid rgba(255,255,255,0.05);
      border-radius:var(--radius);
      height:300px;
      padding:12px;
      transition:150ms;
      box-shadow:0 2px 6px rgba(0,0,0,0.25);
    }

    .card:hover {
      transform:translateY(-3px);
      box-shadow:0 4px 10px rgba(0,0,0,0.22);
    }

    .thumb {
      width:100%;
      height:155px;
      border-radius:10px;
      object-fit:cover;
      box-shadow:0 3px 12px rgba(0,0,0,0.28);
    }

    .meta { text-align:center; padding-top:14px; }
    .meta h3 { font-size:18px; margin-bottom:10px; }

    .play {
      padding:10px 16px;
      border:none;
      border-radius:10px;
      background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      color:white;
      cursor:pointer;
      transition:150ms;
    }

    .play:hover { transform:translateY(-2px); }

    /* MODAL */
    #modal {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.75);
      z-index:50;
      justify-content:center;
      align-items:center;
    }

    #modal > div {
      width:95%;
      max-width:1500px;
      height:90vh;
      background:#0b0b11;
      border-radius:var(--radius);
      border:1px solid rgba(255,255,255,0.05);
      overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.45);
    }

    #closeModal {
      position:absolute;
      right:20px;
      top:16px;
      padding:8px 12px;
      background:rgba(255,255,255,0.12);
      border:none;
      border-radius:8px;
      color:white;
      cursor:pointer;
      z-index:100;
    }

    /* SETTINGS */
    #settingsModal {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.55);
      z-index:60;
      justify-content:center;
      align-items:center;
      transition:250ms;
      opacity:0;
    }

    #settingsModal.show { opacity:1; }

    #settingsModal > div {
      background:#111;
      padding:30px;
      border-radius:12px;
      width:92%;
      max-width:420px;
      border:1px solid rgba(255,255,255,0.08);
      text-align:center;
      transition:300ms;
    }

    .theme-option {
      padding:12px;
      background:rgba(255,255,255,0.04);
      border-radius:10px;
      margin-bottom:8px;
      cursor:pointer;
      transition:150ms;
    }

    .theme-option:hover { background:rgba(255,255,255,0.12); }
    .theme-option.active {
      background:linear-gradient(135deg, hsl(var(--accent2)), hsl(var(--accent1)));
      color:white;
    }
  </style>
</head>
<body>

  <!-- NAVBAR / HUD -->
  <div class="hud">
    <div class="logo">
      <img src="favicon.png" alt="Logo">
      <div>
        <h1>Diamond</h1>
        <small>Upgraded Gaming</small>
      </div>
    </div>

    <div class="right">
      <button id="gamesTab" class="active">Games</button>
      <button id="appsTab">Apps</button>
      <button id="unlockerTab">Unlocker</button>
      <span id="gamesCount" class="pill">Count: 0</span>
      <button id="settingsButton">Settings</button>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <main>
    <section class="hero">
      <h2>Diamond — Upgraded Gaming</h2>
      <p>Jump into any game, instantly.</p>

      <div class="search-wrap">
        <div class="search">
          <input id="q" placeholder="Search..." />
        </div>
      </div>
    </section>

    <section class="grid" id="grid">
      <!-- JS injects game/app cards here -->
    </section>
  </main>

  <!-- GAME/APP MODAL -->
  <div id="modal">
    <div>
      <button id="closeModal">Close</button>
      <iframe id="gameFrame"
        style="width:100%;height:100%;border:none"
        sandbox="allow-scripts allow-same-origin allow-pointer-lock"></iframe>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div id="settingsModal">
    <div>
      <button id="closeSettings"
        style="position:absolute;right:20px;top:16px;border:none;background:rgba(255,255,255,0.08);
        padding:8px 10px;border-radius:8px;color:white;font-size:18px;cursor:pointer;">
        ×
      </button>

      <h3 style="margin-bottom:8px;font-size:26px;">Settings</h3>
      <h4 style="color:var(--text-soft);margin-bottom:16px;font-size:18px;">Select Theme</h4>

      <div id="themeOptions"></div>
    </div>
  </div>
<script>
  const gamesTab = document.getElementById('gamesTab');
  const appsTab = document.getElementById('appsTab');
  const unlockerTab = document.getElementById('unlockerTab');

  const modal = document.getElementById('modal');
  const gameFrame = document.getElementById('gameFrame');
  const closeModal = document.getElementById('closeModal');

  const searchInput = document.getElementById('q');

  const settingsModal = document.getElementById('settingsModal');
  const closeSettings = document.getElementById('closeSettings');
  const settingsButton = document.getElementById('settingsButton');

  const gamesCountElement = document.getElementById('gamesCount');

  let lastActiveTab = 'games';
  let GAMES = [];
  let APPS = [];

  /* Load Games JSON */
  function loadGames() {
    fetch('arcade_data.json')
      .then(r => r.json())
      .then(data => {
        GAMES = data.games || [];
        render(GAMES);
        updateCount();
      });
  }

  /* Load Apps JSON */
  function loadApps() {
    fetch('apps_data.json')
      .then(r => r.json())
      .then(data => {
        APPS = data.apps || [];
        render(APPS);
        updateCount();
      });
  }

  /* Render Grid */
  function render(items) {
    const grid = document.getElementById('grid');
    const q = searchInput.value.toLowerCase();
    grid.innerHTML = '';

    items
      .filter(item => item.title.toLowerCase().includes(q))
      .forEach(item => grid.appendChild(createCard(item)));
  }

  /* Create Card */
  function createCard(item) {
    const el = document.createElement('article');
    el.className = 'card';

    const img = document.createElement('img');
    img.className = 'thumb';

    /* ⭐ LAZY LOAD = no lag */
    img.loading = "lazy";
    img.src = item.thumb;
    img.alt = item.title;

    const meta = document.createElement('div');
    meta.className = 'meta';

    const h3 = document.createElement('h3');
    h3.textContent = item.title;

    const btn = document.createElement('button');
    btn.className = 'play';
    btn.textContent = 'Play';

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      openItem(item);
    });

    meta.appendChild(h3);
    meta.appendChild(btn);
    el.appendChild(img);
    el.appendChild(meta);

    return el;
  }

  /* Open Item in Modal */
  function openItem(item) {
    modal.style.display = 'flex';

    fetch(item.src)
      .then(r => r.text())
      .then(html => {
        gameFrame.contentDocument.open();
        gameFrame.contentDocument.write(html);
        gameFrame.contentDocument.close();
      })
      .catch(err => {
        gameFrame.contentDocument.open();
        gameFrame.contentDocument.write(`
          <h2 style="color:white;padding:20px;">
            Failed to load game
          </h2>
        `);
        gameFrame.contentDocument.close();
      });
  }

  /* Close Modal */
  closeModal.addEventListener('click', () => {
    modal.style.display = 'none';
    gameFrame.src = "";

    if (lastActiveTab === 'games') loadGames();
    else loadApps();
  });

  /* Tabs */
  gamesTab.addEventListener('click', () => {
    lastActiveTab = 'games';
    gamesTab.classList.add('active');
    appsTab.classList.remove('active');
    unlockerTab.classList.remove('active');
    modal.style.display = 'none';
    loadGames();
  });

  appsTab.addEventListener('click', () => {
    lastActiveTab = 'apps';
    appsTab.classList.add('active');
    gamesTab.classList.remove('active');
    unlockerTab.classList.remove('active');
    modal.style.display = 'none';
    loadApps();
  });

  unlockerTab.addEventListener('click', () => {
    unlockerTab.classList.add('active');
    gamesTab.classList.remove('active');
    appsTab.classList.remove('active');

    modal.style.display = 'flex';
    gameFrame.src = "https://ihce0h92o3nndk0.pages.dev/";
  });

  /* ⭐ INSTANT SEARCH (no debounce delay) */
  searchInput.addEventListener('input', () => {
    render(gamesTab.classList.contains('active') ? GAMES : APPS);
  });

  /* Update Count */
  function updateCount() {
    gamesCountElement.textContent = "Count: " +
      (gamesTab.classList.contains('active') ? GAMES.length : APPS.length);
  }

  /* Settings Modal */
  settingsButton.addEventListener('click', () => {
    settingsModal.classList.add('show');
    settingsModal.style.display = 'flex';
  });

  closeSettings.addEventListener('click', () => {
    settingsModal.classList.remove('show');
    setTimeout(() => settingsModal.style.display = 'none', 250);
  });

  /* Load Themes */
  fetch('themes.json')
    .then(r => r.json())
    .then(data => {
      const themeOptions = document.getElementById('themeOptions');

      data.themes.forEach(theme => {
        const opt = document.createElement('div');
        opt.className = 'theme-option';
        opt.textContent = theme.name;

        opt.addEventListener('click', () => {
          Object.keys(theme).forEach(key => {
            document.documentElement.style.setProperty(key, theme[key]);
          });

          document.querySelectorAll('.theme-option')
            .forEach(o => o.classList.remove('active'));
          opt.classList.add('active');
        });

        themeOptions.appendChild(opt);
      });
    });

  /* Load Initial Tab */
  gamesTab.classList.add('active');
  loadGames();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diamond - Better Gaming</title>

  <!-- External CSS hosted on GitHub via JSDelivr -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yourusername/arcade-hub@main/styles.css" />

  <script src="https://cdn.jsdelivr.net/gh/yourusername/arcade-hub@main/game.js" defer></script>
</head>
<body>
  <!-- Particles canvas -->
  <canvas id="particles"></canvas>

  <!-- Orbs -->
  <div class="orb orb--a"></div>
  <div class="orb orb--b"></div>
  <div class="orb orb--c"></div>

  <!-- HUD Navbar -->
  <div class="hud">
    <div class="logo">
      <div class="mark"></div>
      <div>
        <h1>Arcade Hub</h1>
        <div style="font-size:12px;color:rgba(230,238,248,0.7);">Dark Neon Edition</div>
      </div>
    </div>

    <div class="pill" id="versionTag">v1.0</div>
    <div id="motd" style="font-size:13px;color:rgba(230,238,248,0.85);margin-left:8px;"></div>
  </div>

  <main>
    <section class="hero">
      <h2>Diamond â€” Upgraded Gaming</h2>
      <p>Jump into any game, online, for free!</p>
      <div class="search-wrap">
        <div class="search"><input id="q" placeholder="Search games..." /></div>
      </div>
    </section>

    <section class="grid" id="grid">
      <!-- Cards injected by JS -->
    </section>
  </main>

  <!-- Modal for Game Embed -->
  <div id="modal" style="display:none;position:fixed;inset:0;justify-content:center;align-items:center;background:rgba(2,6,23,0.8);z-index:60">
    <div style="width:92%;max-width:1100px;height:80vh;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);box-shadow:0 30px 80px rgba(0,0,0,0.6);background:#07070b">
      <button id="closeModal" style="position:absolute;right:20px;top:16px;z-index:70;padding:8px 12px;border-radius:8px;background:rgba(255,255,255,0.06);border:none;color:#fff;cursor:pointer">Close</button>
      <iframe id="gameFrame" style="width:100%;height:100%;border:none" sandbox="allow-scripts allow-same-origin allow-pointer-lock"></iframe>
    </div>
  </div>

  <script>
    // Game data (initially empty)
    let GAMES = [];
    const grid = document.getElementById('grid');
    const q = document.getElementById('q');
    const modal = document.getElementById('modal');
    const gameFrame = document.getElementById('gameFrame');
    const closeModal = document.getElementById('closeModal');

    // Function to create each game card
    function createCard(game) {
      const el = document.createElement('article');
      el.className = 'card';

      const img = document.createElement('img');
      img.className = 'thumb';
      img.src = game.thumb;
      img.alt = game.title;

      const meta = document.createElement('div'); 
      meta.className = 'meta';
      const h3 = document.createElement('h3'); 
      h3.textContent = game.title;
      const btn = document.createElement('button'); 
      btn.className = 'play'; 
      btn.textContent = 'Play';

      // Event listener for opening game in modal
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        openGame(game);
      });

      meta.appendChild(h3); 
      meta.appendChild(btn);
      el.appendChild(img); 
      el.appendChild(meta);

      // 3D tilt effect on card hover
      el.addEventListener('mousemove', (ev) => {
        const rect = el.getBoundingClientRect();
        const cx = rect.left + rect.width / 2; 
        const cy = rect.top + rect.height / 2;
        const dx = ev.clientX - cx; 
        const dy = ev.clientY - cy;
        const rx = (dy / rect.height) * 8; 
        const ry = -(dx / rect.width) * 8;
        el.style.transform = `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg) translateZ(6px)`;
      });
      
      el.addEventListener('mouseleave', () => { 
        el.style.transform = ''; 
      });

      return el;
    }

    // Function to render game cards based on search filter
    function render(filter = '') {
      grid.innerHTML = '';
      GAMES.filter(g => g.title.toLowerCase().includes(filter.toLowerCase()))
        .forEach(g => grid.appendChild(createCard(g)));
    }

    // Function to open the game in the modal
    function openGame(game) {
      gameFrame.src = game.src;
      modal.style.display = 'flex';
    }

    // Close modal on button click
    closeModal.addEventListener('click', () => {
      modal.style.display = 'none';
      gameFrame.src = '';
    });

    // Search event listener
    q.addEventListener('input', () => render(q.value));

    // Fetching external JSON (game data) from JSDelivr
    fetch('https://cdn.jsdelivr.net/gh/yourusername/arcade-hub@main/arcade_data.json')
      .then(r => r.json())
      .then(data => {
        GAMES = data.games;
        const MESSAGES = data.messages;
        document.getElementById('motd').textContent = MESSAGES[Math.floor(Math.random() * MESSAGES.length)];
        render();
      })
      .catch(err => console.error('JSON load error', err));

    // ---------- Particles (lightweight) ----------
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    
    // Resize canvas to fit screen
    function resize() { 
      canvas.width = innerWidth; 
      canvas.height = innerHeight; 
    }

    addEventListener('resize', resize); 
    resize();

    // Particle system setup
    const particles = [];
    const count = Math.max(10, Math.floor((canvas.width * canvas.height) / 70000));
    for (let i = 0; i < count; i++) 
      particles.push({ 
        x: Math.random() * canvas.width, 
        y: Math.random() * canvas.height, 
        r: 0.5 + Math.random() * 2, 
        vx: (Math.random() - 0.5) * 0.25, 
        vy: (Math.random() - 0.5) * 0.25, 
        hue: Math.floor(Math.random() * 360) 
      });

    // Particle animation loop
    function step() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const g = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      g.addColorStop(0, 'rgba(2,6,23,0.08)'); 
      g.addColorStop(1, 'rgba(10,8,15,0.08)');
      ctx.fillStyle = g; 
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      particles.forEach(p => {
        p.x += p.vx; 
        p.y += p.vy;
        if (p.x < -10) p.x = canvas.width + 10; 
        if (p.x > canvas.width + 10) p.x = -10;
        if (p.y < -10) p.y = canvas.height + 10; 
        if (p.y > canvas.height + 10) p.y = -10;

        ctx.beginPath(); 
        ctx.fillStyle = `hsla(${p.hue},80%,60%,0.10)`; 
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); 
        ctx.fill();
      });

      requestAnimationFrame(step);
    }
    step();
  </script>
</body>
</html>

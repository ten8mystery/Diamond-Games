<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diamond - Better Gaming</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <style>
    /* ---------- Root & Reset ---------- */
    :root {
      --bg: #030308;
      --panel: rgba(255,255,255,0.03);
      --glass: rgba(255,255,255,0.04);
      --accent1: 220 88% 60%; /* Blue */
      --accent2: 280 88% 60%; /* Purple */
      --accent3: 140 75% 50%; /* Green */
      --text-color: #e6eef8; /* Default Text Color */
      --button-text-color: #ffffff; /* Default Button Text Color */
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--text-color);
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial;
    }

/* ---------- Settings Modal Styles ---------- */
#settingsModal {
  display: none;
  position: fixed;
  inset: 0;
  justify-content: center;
  align-items: center;
  background: rgba(2, 6, 23, 0.8);
  z-index: 60;
  transition: opacity 0.3s ease;
}

#settingsModal > div {
  width: 100%;
  max-width: 400px;
  padding: 30px;
  border-radius: 12px;
  background: #111;
  box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
  text-align: center;
  transition: transform 0.3s ease, opacity 0.3s ease;
  opacity: 0;
  transform: translateY(-30px);
}

#settingsModal.show > div {
  opacity: 1;
  transform: translateY(0);
}

button#closeSettings {
  position: absolute;
  top: 10px;
  right: 10px;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  border: none;
  border-radius: 50%;
  font-size: 18px;
  cursor: pointer;
  transition: background 0.3s ease;
}

button#closeSettings:hover {
  background: rgba(255, 255, 255, 0.2);
}

h3 {
  font-size: 24px;
  margin-bottom: 20px;
  color: #fff;
}

h4 {
  font-size: 18px;
  color: #ccc;
  margin-bottom: 15px;
}

#themeOptions {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.theme-option {
  padding: 12px;
  background: var(--panel);
  border-radius: 10px;
  cursor: pointer;
  color: var(--text-color);
  font-size: 18px;
  transition: background 200ms ease, transform 200ms ease;
}

.theme-option:hover {
  background: var(--accent1);
  transform: scale(1.05);
}

.theme-option.active {
  background: var(--accent2);
  transform: scale(1.05);
}

.theme-option:active {
  transform: scale(1.02);
}

    /* ---------- Navbar (HUD) ---------- */
    .hud {
      position: fixed;
      top: 18px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 30;
      display: flex;
      align-items: center;
      gap: 14px;
      width: 92%;
      max-width: 1200px;
      padding: 10px 16px;
      border-radius: 14px;
      background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo .mark {
      width: 40px;
      height: 40px;
      border-radius: 9px;
      box-shadow: 0 8px 30px rgba(145,90,255,0.18);
    }

    .logo h1 {
      font-size: 18px;
    }

    .right {
      margin-left: auto;
      display: flex;
      gap: 10px;
    }

    .pill {
      padding: 8px 12px;
      border-radius: 999px;
      background: var(--panel);
      border: 1px solid rgba(255,255,255,0.03);
      font-size: 13px;
      display: inline-flex;
      align-items: center;
    }

    /* ---------- Button Styles ---------- */
    .hud .right button {
      padding: 12px 24px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      background: linear-gradient(145deg, var(--accent1), var(--accent2));
      color: var(--button-text-color);
      cursor: pointer;
      transition: transform 200ms ease, background 200ms ease, box-shadow 200ms ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .hud .right button:hover {
      transform: translateY(-2px);
      background: linear-gradient(145deg, var(--accent2), var(--accent1));
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
    }

    .hud .right button:active {
      transform: translateY(1px);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    }

    /* Active Tab Button Styles */
    .hud .right button.active {
      background: linear-gradient(145deg, hsl(var(--accent2)), hsl(var(--accent1)));
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }

    /* ---------- Hero Section ---------- */
    .hero {
      padding-top: 110px;
      padding-bottom: 18px;
      text-align: center;
      z-index: 5;
      position: relative;
    }

    .hero h2 {
      font-size: 40px;
      margin: 0 0 8px;
      text-shadow: 0 8px 40px rgba(147,51,234,0.12);
    }

    .hero p {
      margin: 0;
      color: rgba(230, 238, 248, 0.75);
    }

    /* ---------- Search Bar ---------- */
    .search-wrap {
      display: flex;
      justify-content: center;
      margin-top: 18px;
    }

    .search {
      width: 680px;
      max-width: 92%;
      padding: 12px 18px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.04);
      background: var(--glass);
      display: flex;
      gap: 10px;
      align-items: center;
      box-shadow: 0 10px 40px rgba(99, 102, 241, 0.04);
    }

    .search input {
      flex: 1;
      background: transparent;
      border: 0;
      color: inherit;
      font-size: 16px;
      outline: none;
    }

/* ---------- Grid Layout ---------- */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 22px;
  max-width: 1200px;
  margin: 36px auto;
  padding: 0 18px;
  z-index: 5;
}

/* ---------- Card Styling ---------- */
.card {
  position: relative;
  overflow: hidden;
  border-radius: 14px;
  padding: 12px;
  background: rgba(8,9,12,0.8);
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  transition: transform 260ms cubic-bezier(.2,.9,.2,1), box-shadow 260ms;
  will-change: transform, box-shadow, opacity;
  transform-style: preserve-3d;
  backface-visibility: hidden;
  height: 300px; /* Fixed height to prevent stretching */
  display: block !important; /* Force block display */
  flex-direction: column;  /* This might be irrelevant since we are using grid */
  justify-content: space-between;
  width: 100%; /* Ensure it takes full width of its container */
}

    /* Add hover effect to cards */
    .card:hover {
      transform: translateY(-5px); /* Lift effect */
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4); /* Shadow effect */
    }

    .card .thumb {
      width: 100%;
      height: 150px; /* Keep it consistent */
      object-fit: cover;
      border-radius: 10px;
      display: block !important;
    }

    .card .meta {
      padding: 12px 6px;
      text-align: center;
    }

    .card h3 {
      margin: 0 0 8px 0;
      font-size: 18px;
    }

    .card .play {
      display: inline-block;
      padding: 10px 14px;
      border-radius: 10px;
      border: none;
      color: var(--button-text-color); /* Use separate button text color */
      background: linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      box-shadow: 0 10px 30px hsla(var(--accent1), 0.18);
      cursor: pointer;
      transition: transform 160ms;
    }

  </style>
</head>
<body>
  <div class="hud">
    <div class="logo">
      <div class="mark">
        <img src="favicon.png" alt="Logo" style="width: 40px; height: 40px; border-radius: 9px;">
      </div>
      <div>
        <h1>Diamond</h1>
        <div style="font-size:12px;color:rgba(230,238,248,0.7);">Upgraded Gaming</div>
      </div>
    </div>

<div class="right">
  <button id="gamesTab" class="active">Games</button>
  <button id="appsTab">Apps</button>
  <button id="unlockerTab">Unlocker</button> <!-- New Tab -->
  <span id="gamesCount" class="pill"></span>
  <button id="settingsButton">Settings</button>
</div>
  </div>

  <main>
    <section class="hero">
      <h2>Diamond â€” Upgraded Gaming</h2>
      <p>Jump into any game, online, for free!</p>
      <div class="search-wrap">
        <div class="search"><input id="q" placeholder="Search..." /></div>
      </div>
    </section>

    <section class="grid" id="grid">
      <!-- cards injected by JS -->
    </section>
  </main>

  <!-- Modal -->
  <div id="modal" style="display:none;position:fixed;inset:0;justify-content:center;align-items:center;background:rgba(2,6,23,0.8);z-index:60">
    <div style="width:95%;max-width:1500px;height:90vh;border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);box-shadow:0 30px 80px rgba(0,0,0,0.6);background:#07070b">
      <button id="closeModal" style="position:absolute;right:20px;top:16px;z-index:70;padding:8px 12px;border-radius:8px;background:rgba(255,255,255,0.06);border:none;color:#fff;cursor:pointer">Close</button>
      <iframe id="gameFrame" style="width:100%;height:100%;border:none" sandbox="allow-scripts allow-same-origin allow-pointer-lock"></iframe>
    </div>
  </div>

<!-- Settings Modal -->
<div id="settingsModal">
  <div style="background: #111; padding: 30px; border-radius: 12px; box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6); max-width: 400px; width: 100%; text-align: center;">
    <button id="closeSettings" style="position: absolute; right: 20px; top: 16px; padding: 10px 12px; border-radius: 8px; background: rgba(255, 255, 255, 0.1); border: none; color: #fff; cursor: pointer; font-size: 18px;">&times;</button>
    <h3 style="font-size: 24px; color: #fff; margin-bottom: 20px;">Settings</h3>
    <h4 style="font-size: 18px; color: #ccc;">Select Theme</h4>
    <div id="themeOptions" style="display: flex; flex-direction: column; gap: 10px;">
      <!-- Theme options will be injected here -->
    </div>
  </div>
</div>

  <script>
// Fetch the tab and iframe elements
const gamesTab = document.getElementById('gamesTab');
const appsTab = document.getElementById('appsTab');
const unlockerTab = document.getElementById('unlockerTab');
const gameFrame = document.getElementById('gameFrame');
const modal = document.getElementById('modal');
const closeModal = document.getElementById('closeModal');
const settingsButton = document.getElementById('settingsButton');
const settingsModal = document.getElementById('settingsModal');
const closeSettings = document.getElementById('closeSettings');
const gamesCountElement = document.getElementById('gamesCount');

// Track the last active tab
let lastActiveTab = 'games'; // default is 'games'

// Load Games and Apps Data
let GAMES = [];
let APPS = [];

function loadGames() {
  fetch('arcade_data.json')
    .then(r => r.json())
    .then(data => {
      GAMES = data.games;
      render(GAMES);
      updateCount();
    })
    .catch(err => console.error('JSON load error', err));
}

function loadApps() {
  fetch('apps_data.json')
    .then(r => r.json())
    .then(data => {
      APPS = data.apps;
      render(APPS);
      updateCount();
    })
    .catch(err => console.error('JSON load error', err));
}

// Render function to display filtered games/apps
function render(items) {
  const q = document.getElementById('q');
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  items
    .filter(item => item.title.toLowerCase().includes(q.value.toLowerCase()))
    .forEach(item => grid.appendChild(createCard(item)));
}

// Function to create a card
function createCard(item) {
  const el = document.createElement('article');
  el.className = 'card';

  const img = document.createElement('img');
  img.className = 'thumb';
  img.src = item.thumb;
  img.alt = item.title;

  const meta = document.createElement('div');
  meta.className = 'meta';
  const h3 = document.createElement('h3');
  h3.textContent = item.title;
  const btn = document.createElement('button');
  btn.className = 'play';
  btn.textContent = 'Play';
  
  btn.addEventListener('click', (e) => {
    e.stopPropagation();
    openItem(item);
  });

  meta.appendChild(h3);
  meta.appendChild(btn);
  el.appendChild(img);
  el.appendChild(meta);

  return el;
}

// Function to open the selected item in the iframe
function openItem(item) {
  fetch(item.src)
    .then(response => response.text())
    .then(htmlContent => {
      gameFrame.contentDocument.open();
      gameFrame.contentDocument.write(htmlContent);
      gameFrame.contentDocument.close();
      modal.style.display = 'flex';
    })
    .catch(error => {
      console.error('Error loading item content:', error);
      gameFrame.contentDocument.open();
      gameFrame.contentDocument.write(`
        <div style="padding: 20px; color: white; background: #b91c1c; text-align: center; font-family: sans-serif; border-radius: 8px;">
          <h2 style="margin-top: 0; color: white;">ðŸ›‘ Error Loading Item ðŸ›‘</h2>
          <p>Could not load content. This usually happens when the host server sends the wrong file type.</p>
        </div>
      `);
      gameFrame.contentDocument.close();
    });
}

// Function to update the count based on the active tab
function updateCount() {
  const itemCount = gamesTab.classList.contains('active') ? GAMES.length : APPS.length;
  gamesCountElement.textContent = `Count: ${itemCount}`;
}

// Tab Switch Event Listeners

// Games Tab
gamesTab.addEventListener('click', () => {
  gamesTab.classList.add('active');
  appsTab.classList.remove('active');
  unlockerTab.classList.remove('active');
  
  // Load Games and Render them
  loadGames();
  gameFrame.src = ''; // Clear iframe for games
  modal.style.display = 'none'; // Close modal

  // Set last active tab to 'games'
  lastActiveTab = 'games';
});

// Apps Tab
appsTab.addEventListener('click', () => {
  appsTab.classList.add('active');
  gamesTab.classList.remove('active');
  unlockerTab.classList.remove('active');
  
  // Load Apps and Render them
  loadApps();
  gameFrame.src = ''; // Clear iframe for apps
  modal.style.display = 'none'; // Close modal

  // Set last active tab to 'apps'
  lastActiveTab = 'apps';
});

// Unlocker Tab
unlockerTab.addEventListener('click', () => {
  unlockerTab.classList.add('active');
  gamesTab.classList.remove('active');
  appsTab.classList.remove('active');
  
  // Load Unlocker iframe
  gameFrame.src = '/pages/unlocker/index.html'; // Set iframe source
  modal.style.display = 'flex'; // Open modal with iframe content
});

// Close Modal
closeModal.addEventListener('click', () => {
  modal.style.display = 'none';
  gameFrame.src = ''; // Clear iframe content

  // Ensure only the correct tab is active when closing the modal
  if (lastActiveTab === 'games') {
    gamesTab.classList.add('active');
    loadGames();
  } else if (lastActiveTab === 'apps') {
    appsTab.classList.add('active');
    loadApps();
  }
});

// Settings Modal Logic

// Open the settings modal
settingsButton.addEventListener('click', () => {
  settingsModal.style.display = 'flex';
  setTimeout(() => settingsModal.classList.add('show'), 10); // Smooth opening
});

// Close the settings modal
closeSettings.addEventListener('click', () => {
  settingsModal.classList.remove('show');
  setTimeout(() => settingsModal.style.display = 'none', 300); // Smooth closing
});

// Fetch themes from themes.json
fetch('themes.json')
  .then(response => response.json())
  .then(data => {
    if (data && data.themes) {
      data.themes.forEach(theme => {
        const themeOption = document.createElement('div');
        themeOption.className = 'theme-option';
        themeOption.textContent = theme.name;
        themeOption.addEventListener('click', () => changeTheme(theme, themeOption));
        themeOptions.appendChild(themeOption);
      });
    }
  })
  .catch(error => {
    console.error('Error loading themes:', error);
  });

// Function to change the theme
function changeTheme(theme, selectedOption) {
  // Change CSS variables based on the selected theme
  Object.keys(theme).forEach(varName => {
    document.documentElement.style.setProperty(varName, theme[varName]);
  });

  // Update active state for theme options
  document.querySelectorAll('.theme-option').forEach(option => {
    option.classList.remove('active');
  });
  selectedOption.classList.add('active');
}

// Initialize with Games Tab Active
gamesTab.classList.add('active');
loadGames();
  
    // Function to update the count based on active tab
    function updateCount() {
      const itemCount = gamesTab.classList.contains('active') ? GAMES.length : APPS.length;
      gamesCountElement.textContent = `Count: ${itemCount}`;
    }
  </script>
</body>
</html>
